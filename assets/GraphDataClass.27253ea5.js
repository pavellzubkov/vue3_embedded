var s=Object.defineProperty,t=(t,a,n)=>(((t,a,n)=>{a in t?s(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n})(t,"symbol"!=typeof a?a+"":a,n),n);import{N as a,l as n,g as e,J as i}from"./index.678e1d89.js";const h=class{constructor(){t(this,"windowIntervalSec",a("graphWinInterval",30)),t(this,"grInst"),t(this,"recTimer"),t(this,"recIntervalMs",n(200)),t(this,"spnsInGraph",[]),t(this,"spnsInGraphIds",n([])),t(this,"graphIsWindow",a("graphIsWindow",!0)),t(this,"isListNotEmpty",e((()=>this.spnsInGraphIds.value.length>0))),t(this,"graphListLength",e((()=>this.spnsInGraphIds.value.length))),t(this,"isDatastart",n(!1)),t(this,"spnIdExistInList",(s=>this.spnsInGraph.findIndex((t=>t.spnId==s))>-1)),t(this,"setGraphInst",(s=>{this.grInst=s})),t(this,"resetAllData",(()=>{var s;this.stop(),this.spnsInGraph=[],this.spnsInGraphIds.value=[],null==(s=this.grInst)||s.setData([])})),t(this,"addDeleteSpnId",((s,t)=>{if(!t||!this.spnIdExistInList(s)){if(t)0===this.spnsInGraph.length&&this.start(),this.spnsInGraph.push({spnId:s,data:[],type:"line",animation:!1,connectNulls:!1,showSymbol:!1,name:s,sampling:"lttb",emphasis:{disabled:!0},select:{disabled:!0}}),this.spnsInGraphIds.value.push(s);else{const t=this.spnsInGraph.findIndex((t=>t.spnId===s));this.spnsInGraph.splice(t,1),this.spnsInGraphIds.value.splice(t,1)}0===this.spnsInGraph.length&&clearInterval(this.recTimer)}})),t(this,"getSpnIdData",(s=>{var t;const a=i.allSpns.value.find((t=>t._id==s));return a?i.ErrorsDecoder.isSpnIdInActiveCodes(a._id)?null:"number"==typeof a.value.value?a.value.value:Number.parseInt((null==(t=a.value_bin)?void 0:t.value)||"",2):null})),t(this,"setData",((s=!1)=>{var t;this.grInst&&this.grInst.isChartExist()&&this.grInst.setData(this.spnsInGraph),s&&!this.recTimer&&(null==(t=this.grInst)||t.showDataZoom(!0))})),t(this,"recData",(()=>{this.spnsInGraph.forEach((s=>{const t=this.getSpnIdData(s.spnId),a=100*Math.round(Date.now()/100);if(s.data.push({value:[a,t]}),this.graphIsWindow.value&&this.windowIntervalSec.value>0){let t=(a-s.data[0].value[0])/1e3;for(;t>this.windowIntervalSec.value;)s.data.shift(),t=(a-s.data[0].value[0])/1e3}})),this.setData()})),t(this,"clearGraphData",(()=>{this.spnsInGraph.forEach((s=>{s.data=[]})),this.setData()})),t(this,"start",(()=>{var s;this.isDatastart.value=!0,null==(s=this.grInst)||s.showDataZoom(!1),this.recTimer=setInterval(this.recData,200)})),t(this,"stop",(()=>{this.isDatastart.value=!1,this.grInst&&this.grInst.showDataZoom(!0),clearInterval(this.recTimer)}))}};let r=h;t(r,"instance"),t(r,"getInstance",(()=>(h.instance||(h.instance=new h),h.instance)));const l=r.getInstance();export{l as G};
